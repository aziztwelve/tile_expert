<?xml version="1.0" encoding="UTF-8"?>
<phpunit xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:noNamespaceSchemaLocation="vendor/phpunit/phpunit/phpunit.xsd"
         bootstrap="tests/bootstrap.php"
         colors="true"
         failOnRisky="true"
         failOnWarning="true">

    <php>
        <!-- PHP -->
        <ini name="display_errors" value="1"/>
        <ini name="error_reporting" value="-1"/>

        <!-- Symfony -->
        <server name="SHELL_VERBOSITY" value="-1"/>

        <env name="KERNEL_CLASS" value="App\Kernel"/>
        <env name="APP_SECRET" value="$ecretf0rt3st"/>
        <env name="APP_ENV" value="test"/>
        <env name="APP_DEBUG" value="0"/>

        <!-- Routing -->
        <env name="DEFAULT_URI" value="http://localhost"/>

        <!-- Database (TEST) -->
        <env name="POSTGRES_HOST" value="localhost"/>
        <env name="POSTGRES_PORT" value="5432"/>
        <env name="POSTGRES_DB" value="tiledb"/>
        <env name="POSTGRES_USER" value="postgres"/>
        <env name="POSTGRES_PASSWORD" value="postgres"/>
        <env name="DATABASE_URL"
             value="postgresql://postgres:postgres@localhost:5432/tiledb?serverVersion=15&amp;charset=utf8"/>

        <!-- Manticore Search -->
        <env name="MANTICORE_HOST" value="localhost"/>
        <env name="MANTICORE_PORT" value="9308"/>
        <env name="MANTICORE_SQL_PORT" value="9306"/>

        <!-- Messenger -->
        <env name="MESSENGER_TRANSPORT_DSN" value="sync://"/>

        <!-- External services -->
        <env name="TILE_EXPERT_BASE_URL" value="https://tile.expert/en-us/tile"/>

        <!-- Cache -->
        <env name="CACHE_ADAPTER" value="cache.adapter.array"/>

        <!-- Logging -->
        <env name="LOG_LEVEL" value="error"/>
    </php>

    <testsuites>
        <testsuite name="Feature">
            <directory>tests/Feature</directory>
        </testsuite>
        <testsuite name="Unit">
            <directory>tests/Unit</directory>
        </testsuite>
    </testsuites>

    <coverage processUncoveredFiles="true">
        <include>
            <directory suffix=".php">src</directory>
        </include>
        <exclude>
            <directory>src/DataFixtures</directory>
            <file>src/Kernel.php</file>
        </exclude>
    </coverage>

    <extensions>
        <extension class="DAMA\DoctrineTestBundle\PHPUnit\PHPUnitExtension"/>
    </extensions>

</phpunit>
